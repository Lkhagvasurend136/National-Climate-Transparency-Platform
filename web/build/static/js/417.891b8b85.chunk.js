"use strict";(self.webpackChunkweb_mrv=self.webpackChunkweb_mrv||[]).push([[417],{6770:function(e,n,t){t.d(n,{A:function(){return o}});var a=t(6237),i=t(7419),r=t(1645),l=t(5696),s=t(8387),c=t(579),o=function(e){var n=e.calledIn,t=e.entId,o=e.isValidated;return(0,c.jsx)(i.A,{children:(0,c.jsx)(r.A,{children:(0,c.jsx)(l.A,{title:o?"Validated ".concat(n):void 0,showArrow:!1,placement:"right",children:(0,c.jsx)(s.A,{icon:o?(0,c.jsx)(a.A,{style:{color:"#8A1538"}}):void 0,className:"entity-id-card",children:"".concat(n," ID: ").concat(t)})})})})}},1798:function(e,n,t){t.r(n),t.d(n,{default:function(){return V}});var a=t(9379),i=t(2007),r=t(467),l=t(5544),s=t(4117),c=t(4406),o=t(289),u=t(8193),d=t(7419),A=t(1645),m=t(3307),h=t(9421),p=t(5696),f=t(5397),v=t(5043),x=t(3216),j=t(2856),y=function(e){return e.NEEDED="Needed",e.RECEIVED="Received",e}({}),b=function(e){return e.INTERNATIONAL="International",e.NATIONAL="National",e}({}),g=function(e){return e.MULTILATERAL="Multilateral",e.BILATERAL="Bilateral",e.REGIONAL="Regional",e.OTHER="Other",e}({}),N=function(e){return e.GRANT="Grant",e.CONCES_LOAN="Concessional Loan",e.NON_CONCES_LOAN="Non-concessional Loan",e.EQUITY="Equity",e.GUARANTEE="Guarantee",e.INSURANCE="Insurance",e.OTHERS="Others",e}({}),I=function(e){return e.GRANT="Grant",e.EQUITY="Equity",e.COMM_BONDS="Commercial Bonds (private sector)",e.COMM_LOAN="Commercial Loan (private sector)",e.NAT_BUDGET="National Budget",e.NAT_FISCAL="National Fiscal Policy",e.NAT_MONETARY="National Monetary Policy",e.OTHERS="Others",e}({}),S=function(e){return e.COMMITTED="Committed",e.RECEIVED="Received",e}({}),F=function(e){return e.AFC="AFC",e.AFD="AFD",e.AFDB="AFDB",e.EBRD="EBRD",e.EIB="EIB",e.FAO="FAO",e.GIZ="GIZ",e.IMF="IMF",e.IMO="IMO",e.IUCN="IUCN",e.NEFCO="NEFCO",e.UNWO="UN Women",e.UNDP="UNDP",e.UNEP="UNEP",e.UNESCO="UNESCO",e.UNFCCC="UNFCCC",e.UNFPA="UNFPA",e.UNICEF="UNICEF",e.UNIDO="UNIDO",e.USAID="USAID",e.WFP="WFP",e.WMO="WMO",e.WB="World Bank",e}({}),C=t(6770),k=t(1054),E=t(5432),T=t(1186),O=t(7731),R=t(6240),w=t(8255),D=t(9620),U=t(8417),q=t(1713),z=t(9662),L=t(1966),M=t(579),P=c.A.Option,W="13px",V=function(e){var n=e.method,t=o.A.useForm(),V=(0,l.A)(t,1)[0],B=(0,s.Bd)(["supportForm","entityAction","error"]).t,_="view"===n,G=(0,E.$T)("Support",n),Z=(0,x.Zp)(),H=(0,j.w5)(),K=H.get,Y=H.post,Q=H.put,$=H.delete,J=(0,R.V8)(),X=(0,q.ur)(),ee=X.isValidationAllowed,ne=X.setIsValidationAllowed,te=(0,x.g)().entId,ae=(0,k.F)(n),ie=(0,v.useState)(!1),re=(0,l.A)(ie,2),le=re[0],se=re[1],ce=(0,v.useState)(!1),oe=(0,l.A)(ce,2),ue=oe[0],de=oe[1],Ae=(0,v.useState)(!0),me=(0,l.A)(Ae,2),he=me[0],pe=me[1],fe=(0,v.useState)(!1),ve=(0,l.A)(fe,2),xe=ve[0],je=ve[1],ye=(0,v.useState)(!1),be=(0,l.A)(ye,2),ge=be[0],Ne=be[1],Ie=(0,v.useState)(!1),Se=(0,l.A)(Ie,2),Fe=Se[0],Ce=Se[1],ke=(0,v.useState)(!1),Ee=(0,l.A)(ke,2),Te=Ee[0],Oe=Ee[1],Re=(0,v.useState)(!1),we=(0,l.A)(Re,2),De=we[0],Ue=we[1],qe=(0,v.useState)(!1),ze=(0,l.A)(qe,2),Le=ze[0],Me=ze[1],Pe=(0,v.useState)(),We=(0,l.A)(Pe,2),Ve=We[0],Be=We[1],_e=(0,v.useState)(),Ge=(0,l.A)(_e,2),Ze=Ge[0],He=Ge[1],Ke=(0,v.useState)(),Ye=(0,l.A)(Ke,2),Qe=Ye[0],$e=Ye[1],Je=(0,v.useState)([]),Xe=(0,l.A)(Je,2),en=Xe[0],nn=Xe[1],tn=function(e){"International"===e?(Oe(!0),Ue(!1)):"National"===e?(Oe(!1),Ue(!0)):(Oe(!1),Ue(!1))},an=function(){var e=(0,r.A)((0,i.A)().m(function e(){var n,t,a,r;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n={sort:{key:"activityId",order:"ASC"}},e.n=1,Y("national/activities/query",n);case 1:t=e.v,a=[],t.data.forEach(function(e){a.push({id:e.activityId,title:e.title})}),nn(a),e.n=3;break;case 2:e.p=2,r=e.v,(0,U.s)(r);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),rn=function(){var e=(0,r.A)((0,i.A)().m(function e(){var t,a,r,l,s,c,o,u,d,A,m,h,p;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if("create"===n||!te){e.n=5;break}return e.p=1,a={filterAnd:[{key:"supportId",operation:"=",value:te}]},e.n=2,Y("national/supports/query",a);case 2:1===(t=e.v).response.data.total&&(p=t.data[0],V.setFieldsValue({activityId:null!==(r=null===(l=p.activity)||void 0===l?void 0:l.activityId)&&void 0!==r?r:void 0,direction:p.direction,financeNature:p.financeNature,internationalSupportChannel:p.internationalSupportChannel,internationalFinancialInstrument:null!==(s=p.internationalFinancialInstrument)&&void 0!==s?s:void 0,nationalFinancialInstrument:null!==(c=p.nationalFinancialInstrument)&&void 0!==c?c:void 0,financingStatus:p.financingStatus,internationalSource:null!==(o=p.internationalSource)&&void 0!==o?o:void 0,nationalSource:null!==(u=p.nationalSource)&&void 0!==u?u:void 0,requiredAmount:p.requiredAmount,receivedAmount:p.receivedAmount,exchangeRate:p.exchangeRate}),He(null!==(d=p.requiredAmount)&&void 0!==d?d:void 0),$e(null!==(A=p.receivedAmount)&&void 0!==A?A:void 0),Be(null!==(m=p.exchangeRate)&&void 0!==m?m:void 0),tn(p.financeNature),"Received"===p.direction&&Me(!0),de(null!==(h=p.validated)&&void 0!==h&&h)),e.n=4;break;case 3:e.p=3,e.v,Z("/support");case 4:pe(!0);case 5:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),ln=function(){var e=(0,r.A)((0,i.A)().m(function e(t){var a,r,l;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,je(!0),t.exchangeRate=parseFloat(t.exchangeRate),t.requiredAmount=parseFloat(t.requiredAmount),t.receivedAmount=parseFloat(t.receivedAmount),"create"!==n){e.n=2;break}return e.n=1,Y("national/supports/add",(0,w.x)(t,"support"));case 1:a=e.v,e.n=4;break;case 2:if("update"!==n){e.n=4;break}return t.supportId=te,e.n=3,Q("national/supports/update",(0,w.x)(t,"support"));case 3:a=e.v;case 4:r=B("create"===n?"supportCreationSuccess":"supportUpdateSuccess"),200!==a.status&&201!==a.status||(u.Ay.open({type:"success",content:r,duration:3,style:{textAlign:"right",marginRight:15,marginTop:10}}),Z("/support")),e.n=6;break;case 5:e.p=5,l=e.v,(0,U.s)(l);case 6:return e.p=6,je(!1),e.f(6);case 7:return e.a(2)}},e,null,[[0,5,6,7]])}));return function(n){return e.apply(this,arguments)}}(),sn=function(){var e=(0,r.A)((0,i.A)().m(function e(){var n,t,a,r;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,Ne(!0),!te){e.n=2;break}return n={entityId:te,validateStatus:!ue},e.n=1,Y("national/supports/validateStatus",n);case 1:200!==(t=e.v).status&&201!==t.status||(u.Ay.open({type:"success",content:B(ue?"supportUnvalidateSuccess":"supportValidateSuccess"),duration:3,style:{textAlign:"right",marginRight:15,marginTop:10}}),Z("/support"));case 2:e.n=7;break;case 3:if(e.p=3,null===(a=e.v)||void 0===a||!a.status){e.n=6;break}if(403!==a.status){e.n=5;break}return r=ne,e.n=4,(0,E.e)(K);case 4:r(e.v);case 5:(0,U.s)(a),e.n=7;break;case 6:(0,U.s)(a,"".concat(te," Validation Failed"));case 7:return e.p=7,Ne(!1),e.f(7);case 8:return e.a(2)}},e,null,[[0,3,7,8]])}));return function(){return e.apply(this,arguments)}}(),cn=function(){var e=(0,r.A)((0,i.A)().m(function e(){var n,t,a;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,je(!0),e.n=1,(0,E.cb)(1e3);case 1:if(!te){e.n=3;break}return n={entityId:te},e.n=2,$("national/supports/delete",n);case 2:200!==(t=e.v).status&&201!==t.status||(u.Ay.open({type:"success",content:B("supportDeleteSuccess"),duration:3,style:{textAlign:"right",marginRight:15,marginTop:10}}),Z("/support"));case 3:e.n=5;break;case 4:e.p=4,null!==(a=e.v)&&void 0!==a&&a.message?(0,U.s)(a):(0,U.s)(a,"".concat(te," Delete Failed"));case 5:return e.a(2)}},e,null,[[0,4]])}));return function(){return e.apply(this,arguments)}}(),on=function(e,n){switch(n){case"needed":He(e);break;case"received":$e(e);break;case"rate":Be(e)}};return(0,v.useEffect)(function(){var e=(null!==Ze&&void 0!==Ze?Ze:0)/(null!==Ve&&void 0!==Ve?Ve:0),n=(null!==Qe&&void 0!==Qe?Qe:0)/(null!==Ve&&void 0!==Ve?Ve:0);V.setFieldsValue({neededLocal:e>0?parseFloat(e.toFixed(2)):null,receivedLocal:n>0?parseFloat(n.toFixed(2)):null})},[Ve,Ze,Qe]),(0,v.useEffect)(function(){Promise.all([an(),rn()]).then(function(){se(!0)})},[]),(0,M.jsxs)("div",{className:"content-container",children:[(0,M.jsx)(z.A,{icon:(0,M.jsx)(L.A,{style:{color:"#ff4d4f",fontSize:"120px"}}),isDanger:!0,content:{primaryMsg:"".concat(B("deletePrimaryMsg")," ").concat(te),secondaryMsg:B("deleteSecondaryMsg"),cancelTitle:B("entityAction:cancel"),actionTitle:B("entityAction:delete")},actionRef:te,doAction:cn,open:Fe,setOpen:Ce},"delete_popup"),(0,M.jsx)("div",{className:"title-bar",children:(0,M.jsx)("div",{className:"body-title",children:B(G)})}),(0,M.jsx)(o.A,{form:V,onFinish:ln,layout:"vertical",onValuesChange:function(){pe(!1)},children:!xe&&le?(0,M.jsxs)("div",{className:"support-form",children:[(0,M.jsxs)("div",{className:"form-section-card",children:[(0,M.jsx)("div",{className:"form-section-header",children:B("generalInfoTitle")}),"create"!==n&&te&&(0,M.jsx)(C.A,{calledIn:"Support",entId:te,isValidated:ue}),(0,M.jsxs)(d.A,{gutter:30,children:[(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.FW),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("selectActivityTitle")}),name:"activityId",rules:[ae.required],children:(0,M.jsx)(c.A,{size:"large",style:{fontSize:W},disabled:_,showSearch:!0,children:en.map(function(e){return(0,M.jsx)(P,{value:e.id,children:"".concat(e.id," - ").concat(e.title)},e.id)})})})})),(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.FW),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("supportDirectionTitle")}),name:"direction",rules:[ae.required],children:(0,M.jsx)(c.A,{size:"large",style:{fontSize:W},disabled:_,showSearch:!0,onChange:function(e){V.setFieldsValue({financingStatus:void 0}),Me("Received"===e)},children:Object.values(y).map(function(e){return(0,M.jsx)(P,{value:e,children:e},e)})})})}))]}),(0,M.jsxs)(d.A,{gutter:30,children:[(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.FW),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("financeNatureTitle")}),name:"financeNature",rules:[ae.required],children:(0,M.jsx)(c.A,{size:"large",style:{fontSize:W},disabled:_,showSearch:!0,onChange:function(e){V.setFieldsValue({internationalFinancialInstrument:void 0,nationalFinancialInstrument:void 0,internationalSource:void 0,nationalSource:void 0}),tn(e)},children:Object.values(b).map(function(e){return(0,M.jsx)(P,{value:e,children:e},e)})})})})),(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.FW),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("supportChannelTitle")}),name:"internationalSupportChannel",rules:[{required:!_,message:"Required Field"}],children:(0,M.jsx)(c.A,{size:"large",style:{fontSize:W},disabled:_,showSearch:!0,children:Object.values(g).map(function(e){return(0,M.jsx)(P,{value:e,children:e},e)})})})}))]}),(0,M.jsxs)(d.A,{gutter:30,children:[Te&&(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.FW),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("intFinancialInstrumentTitle")}),name:"internationalFinancialInstrument",rules:[{required:!_&&Te,message:"Required Field"}],children:(0,M.jsx)(c.A,{size:"large",style:{fontSize:W},disabled:_,showSearch:!0,children:Object.values(N).map(function(e){return(0,M.jsx)(P,{value:e,children:e},e)})})})})),De&&(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.FW),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("nationalFinanceInstrument")}),name:"nationalFinancialInstrument",rules:[{required:!_&&De,message:"Required Field"}],children:(0,M.jsx)(c.A,{size:"large",style:{fontSize:W},disabled:_,showSearch:!0,children:Object.values(I).map(function(e){return(0,M.jsx)(P,{value:e,children:e},e)})})})})),Te&&(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.FW),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("internationalSourceTitle")}),name:"internationalSource",children:(0,M.jsx)(c.A,{size:"large",mode:"multiple",style:{fontSize:W},allowClear:!0,disabled:_,showSearch:!0,children:Object.values(F).map(function(e){return(0,M.jsx)(P,{value:e,children:e},e)})})})})),De&&(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.FW),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("nationalSourceTitle")}),name:"nationalSource",children:(0,M.jsx)(m.A,{className:"form-input-box",disabled:_,onChange:function(e){""===e.target.value&&V.setFieldsValue({nationalSource:void 0})}})})}))]}),(0,M.jsxs)(d.A,{gutter:30,children:[(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.FW),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("financeStatus")}),name:"financingStatus",rules:[{required:!_&&Le,message:"Required Field"}],children:(0,M.jsx)(c.A,{size:"large",style:{fontSize:W},disabled:_||!Le,showSearch:!0,children:Object.values(S).map(function(e){return(0,M.jsx)(P,{value:e,children:e},e)})})})})),(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.FW),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("exchangeRateTitle")}),name:"exchangeRate",rules:[ae.greaterThanZero,ae.required],children:(0,M.jsx)(m.A,{type:"number",min:0,step:.01,className:"form-input-box",onChange:function(e){var n=parseFloat(e.target.value);on(n,"rate")},onKeyDown:function(e){"-"!==e.key&&"e"!==e.key&&"+"!==e.key||e.preventDefault()},disabled:_})})}))]}),(0,M.jsxs)(d.A,{gutter:30,children:[(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D._C),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("neededUSDTitle")}),name:"requiredAmount",rules:[ae.required],children:(0,M.jsx)(m.A,{type:"number",min:0,step:.01,className:"form-input-box",onChange:function(e){var n=parseFloat(e.target.value);on(n,"needed")},onKeyDown:function(e){"-"!==e.key&&"e"!==e.key&&"+"!==e.key||e.preventDefault()},disabled:_})})})),(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D._C),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header-small",children:B("neededLocalTitle")}),name:"neededLocal",children:(0,M.jsx)(m.A,{type:"number",className:"form-input-box",disabled:!0})})})),(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D._C),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header",children:B("receivedUSDTitle")}),name:"receivedAmount",rules:[ae.required],children:(0,M.jsx)(m.A,{type:"number",min:0,step:.01,className:"form-input-box",onChange:function(e){var n=parseFloat(e.target.value);on(n,"received")},onKeyDown:function(e){"-"!==e.key&&"e"!==e.key&&"+"!==e.key||e.preventDefault()},disabled:_})})})),(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D._C),{},{children:(0,M.jsx)(o.A.Item,{label:(0,M.jsx)("label",{className:"form-item-header-small",children:B("receivedLocalTitle")}),name:"receivedLocal",children:(0,M.jsx)(m.A,{type:"number",className:"form-input-box",disabled:!0})})}))]})]}),"create"===n&&(0,M.jsxs)(d.A,{className:"sticky-footer",gutter:20,justify:"end",children:[(0,M.jsx)(A.A,{children:(0,M.jsx)(h.A,{type:"default",size:"large",block:!0,onClick:function(){Z("/support")},children:B("entityAction:cancel")})}),(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.Cs),{},{children:(0,M.jsx)(o.A.Item,{children:(0,M.jsx)(h.A,{type:"primary",size:"large",block:!0,htmlType:"submit",children:B("entityAction:add")})})}))]}),"view"===n&&(0,M.jsxs)(d.A,{className:"sticky-footer",gutter:20,justify:"end",children:[(0,M.jsx)(A.A,{children:(0,M.jsx)(h.A,{type:"default",size:"large",block:!0,onClick:function(){Z("/support")},children:B("entityAction:back")})}),J.can(T.rc.Validate,O.v)&&(0,M.jsx)(A.A,{children:(0,M.jsx)(o.A.Item,{children:(0,M.jsx)(p.A,{placement:"topRight",title:ee?void 0:B("error:validationPermissionRequired"),showArrow:!1,children:(0,M.jsx)(h.A,{type:"primary",size:"large",block:!0,onClick:function(){sn()},loading:ge,disabled:!ee,children:B(ue?"entityAction:unvalidate":"entityAction:validate")})})})})]}),"update"===n&&(0,M.jsxs)(d.A,{className:"sticky-footer",gutter:20,justify:"end",children:[(0,M.jsx)(A.A,{children:(0,M.jsx)(h.A,{type:"default",size:"large",block:!0,onClick:function(){Z("/support")},children:B("entityAction:cancel")})}),J.can(T.rc.Delete,O.v)&&(0,M.jsx)(A.A,{children:(0,M.jsx)(h.A,{type:"default",size:"large",block:!0,onClick:function(){Ce(!0)},style:{color:"red",borderColor:"red"},children:B("entityAction:delete")})}),(0,M.jsx)(A.A,(0,a.A)((0,a.A)({},D.Cs),{},{children:(0,M.jsx)(o.A.Item,{children:(0,M.jsx)(h.A,{type:"primary",size:"large",block:!0,htmlType:"submit",disabled:he,children:B("entityAction:update")})})}))]})]}):(0,M.jsx)(f.A,{className:"loading-center",size:"large"})})]})}},8255:function(e,n,t){t.d(n,{x:function(){return c}});var a=t(9379),i=["comments"],r=["additionalProjectNumber","internationalImplementingEntities","comment"],l=["measure","nationalImplementingEntity","internationalImplementingEntity","anchoredInNationalStrategy","meansOfImplementation","technologyType","etfDescription","comment","achievedGHGReductionAlternate"],s=["internationalSource","nationalSource","financingStatus","nationalFinancialInstrument","internationalFinancialInstrument","internationalSupportChannel"],c=function(e,n){var t=[];switch(n){case"action":break;case"programme":t=i;break;case"project":t=r;break;case"activity":t=l;break;case"support":t=s}for(var c=(0,a.A)({},e),o=0,u=t;o<u.length;o++){var d=u[o];c.hasOwnProperty(d)&&("string"===typeof c[d]&&""===c[d]||c[d]instanceof Array&&0===c[d].length||"undefined"===typeof c[d])&&(c[d]=null)}return c}},1054:function(e,n,t){t.d(n,{F:function(){return i}});var a=t(454),i=function(e){return{required:{required:"view"!==e,message:"Required Field"},number:{pattern:/^[0-9]+$/,message:"Please enter a valid number"},greaterThanZero:function(e){return(0,a.A)(e),{validator:function(e,n){return n?n>0?Promise.resolve():Promise.reject("Need to be Greater than Zero"):Promise.resolve()}}}}}}}]);
//# sourceMappingURL=417.891b8b85.chunk.js.map